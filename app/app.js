//
// Dropdown
//

'use strict';

var Dropdown = (function() {
	// Variables

	var $dropdown = $('.dropdown-animate'),
		$dropdownSubmenu = $('a.dropdown-toggle');

	// Methods

	function hideDropdown($this) {
		// Add additional .hide class for animated dropdown menus in order to apply some css behind
		// var $dropdownMenu = $this.find('.dropdown-menu');
		//
		// $dropdownMenu.addClass('hide');
		//
		// setTimeout(function(){
		//     $dropdownMenu.removeClass('hide');
		// }, 300);
	}

	function initSubmenu($this) {
		if (!$this.next().hasClass('show')) {
			$this.parents('.dropdown-menu').first().find('.show').removeClass('show');
		}

		var $submenu = $this.next('.dropdown-menu');

		$submenu.toggleClass('show');
		$submenu.parent().toggleClass('show');

		$this
			.parents('.nav-item.dropdown.show')
			.on('hidden.bs.dropdown', function(e) {
				$('.dropdown-submenu .show').removeClass('show');
			});
	}

	// Events

	if ($dropdown.length) {
		$dropdown.on({
			'hide.bs.dropdown': function() {
				hideDropdown($dropdown);
			}
		});
	}

	if ($dropdownSubmenu.length) {
		$dropdownSubmenu.on('click', function(e) {
			initSubmenu($(this));

			return false;
		});
	}
})();
